<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>GlobalQuran.com - API Calls</title>
		<meta name="keywords" content="keywords, here"/>
		<meta name="description" content="your description here"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	    <meta name="description" content="">
	    <meta name="author" content="">
	
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
	    <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
		
	</head>
	<body>
		<h2>How many words in ayah?</h2>
		<form method="GET" action="?">
			<input type="text" id="surah" placeholder="surah 2 and ayah 1 as '2:1'" style="width: 300px;"/>
			<button type="submit" id="count">How many words?</button>
		</form>
		
		<div id="words" style="margin:1em;font-size: 14px;">
		</div>
		
		<hr />
		<h2>What is the word id?</h2>
		<form method="GET" action="?">
			<input type="text" id="word" placeholder="surah 2,  ayah 1 and word 5 as '2:1:5'" style="width: 300px;"/>
			<button type="submit" id="location">get location</button>
		</form>
		
		<div id="location-text" style="margin:1em;font-size: 14px;">
		</div>
		
		<hr />
		
		
		<h2>Quran, Translation & Recitor List</h2>
		Quran List: <div id="quran-list-data"></div><br/>
		Translation List: <div id="trans-list-data"></div><br/>
		Recitor List: <div id="recitor-list-data"></div>
		
		<hr/>
		
		<h2>Quran Surah Text</h2>
		<form method="GET" action="?">
			<input type="hidden" value="quran-simple" id="quranID" />
			Surah Number: <input type="text" value="1" id="surahNumber">
			<button type="submit" id="newSurah">Load</button>
		</form><br/><br/>
		<div id="quran-text"></div><br/>
		
		<script src="jquery.js"></script>
		<script src="Quran.js"></script>
		<script>
			Quran.init()
			jQuery(function($) {
				
				// word count  script
				$('#count').on('click', function() {
					var surah = $('#surah').val();
					
					sa = surah.split(':', 2);
					surah = sa['0'];
					ayah  = sa['1'];
					
					if (!ayah && !surah)
					{
						alert('please set ayah like this surah:ayah 2:10');
						return false;
					}
					else if (!ayah)
					{
						ayahs = Quran.surah.detail(surah).ayahs;
						$('#words').html('<h1>'+Quran.surah.name(surah, 'english_name')+' '+ayahs+' ayahs</h1>');
						
						li = '<ol>';
						for (ayah=1; ayah<=ayahs; ayah++)
						{
							li += '<li>'+Quran.word.count(surah, ayah)+' words</li>';
						};
						li += '</ol>';
						
						$('#words').append(li);
					}
					else
					{
						$('#words').prepend(Quran.word.count(surah, ayah)+' words in the ayah '+ayah+' of surah '+Quran.surah.name(surah, 'english_name')+'<br>');
					}
		
					
					return false;
				});
				
				// word location  script
				$('#location').on('click', function() {
					var surah = $('#word').val();
					
					sa = surah.split(':', 3);
					surah = sa['0'];
					ayah  = sa['1'];
					word  = sa['2'];
					
					if (!ayah || !surah || !word )
					{
						alert('please set word like this surah:ayah:word 2:10:2');
						return false;
					}
					else
					{
						$('#location-text').prepend(Quran.word.number(surah, ayah, word)+' is the id for the word '+word+' in ayah number '+ayah+' of surah '+Quran.surah.name(surah, 'english_name')+'<br>');
					}
		
					
					return false;
				});
				
				
				
				// Quran list & Recitor List 
				$.ajaxSetup({ cache: true, jsonpCallback: 'quranData' }); // define ajax setup
				$.getJSON("http://api.globalquran.com/quran?jsoncallback=?", {
				    format: "jsonp"
				}, function(data)
				{    
				    /* Quran List */
				    $('#quran-list-data').append('Select Quran: ');
				    $("<select>").attr('id', 'quranList').appendTo("#quran-list-data");
				    $("<option>").attr('selected', 'selected').html('Select Quran').appendTo('#quranList');
				    $.each(data.quranList, function(quranID, by)
				    {
					if (by.format == 'text' && by.type == 'quran')
				            $("<option>").val(quranID).html(by.english_name+' '+by.native_name).appendTo('#quranList');
				    });
				    
				    
				    /* Translation List */
				    $('#trans-list-data').append('Select Translation: ');
				    $("<select>").attr('id', 'transList').appendTo("#trans-list-data");
				    $("<option>").attr('selected', 'selected').html('Select Translation').appendTo('#transList');
				    $.each(data.quranList, function(quranID, by)
				    {
					if (by.format == 'text' && by.type == 'translation')
				            $("<option>").val(quranID).html(by.english_name+' '+by.native_name).appendTo('#transList');
				    });
				    
				    /* Recitor List */
				    $('#recitor-list-data').append('Select Recitor: ');
				    $("<select>").attr('id', 'recitorList').appendTo("#recitor-list-data");
				    $("<option>").attr('selected', 'selected').html('Select Translation').appendTo('#recitorList');
				    $.each(data.quranList, function(quranID, by)
				    {
						if (by.format == 'audio')
				            $("<option>").val(quranID).html(by.english_name+' '+by.native_name).appendTo('#recitorList');
				    });
				    
				    loadSurahText('quran-simple', $('#surahNumber').val());
				    
				    $("#quranList,#transList").change(function() {
						loadSurahText($(this).val(), $('#surahNumber').val());
					});
				});
			
				
				
				$("#newSurah").click(function() {
					
					loadSurahText($('#quranID').val(), $('#surahNumber').val());
					return false;
				});
				
				
				function loadSurahText (quranID, surahNo)
				{					
					$.ajaxSetup({ cache: true, jsonpCallback: 'quranData' }); // define ajax setup
					$.getJSON("http://api.globalquran.com/surah/"+surahNo+"/"+quranID+"?jsoncallback=?", {
					    format : "jsonp"
					}, function(data)
					{    
						$("#quran-text").text('');
					    $.each(data.quran, function(i, by)
					    {
							$.each(by, function (verseNo, line) {
						    	$("<p>").html(line.surah+':'+line.ayah+' '+line.verse).appendTo("#quran-text");
							});
					    });
					});
					
					$('#quranID').val(quranID);
				}
			   
			});
		</script>
	</body>
</html>